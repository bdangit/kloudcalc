var OS={LINUX:{name:"Linux"},WIN:{name:"Windows"}},VENDORS={AWS:{name:"Amazon Web Services",code:"AWS"}},AWS={TIMESTAMP:"2012-05-31 2341 PST",REGIONS:{US_EAST_1:{index:1,name:"US East (Virgina)",code:"US_EAST_1"},US_WEST_1:{index:2,name:"US West (Oregon)",code:"US_WEST_1"},US_WEST_2:{index:3,name:"US West (Northern California)",code:"US_WEST_2"},EU_WEST_1:{index:4,name:"EU (Ireland)",code:"EU_WEST_1"},AP_SOUTHEAST_1:{index:5,name:"Asia Pacific (Singapore)",code:"AP_SOUTHEAST_1"},AP_NORTHEAST_1:{index:6,
name:"Asia Pacific (Tokyo)",code:"AP_NORTHEAST_1"},SA_EAST_1:{index:7,name:"South America (Sao Paulo)",code:"SA_EAST_1"}},COMPUTE:{EC2:{T1_MICRO:{name:"t1.micro",LINUX:{US_EAST_1:{index:1,price:0.02},US_WEST_1:{index:2,price:0.02},US_WEST_2:{index:3,price:0.025},EU_WEST_1:{index:4,price:0.025},AP_SOUTHEAST_1:{index:5,price:0.025},AP_NORTHEAST_1:{index:6,price:0.027},SA_EAST_1:{index:7,price:0.027}},WIN:{US_EAST_1:{index:1,price:0.03},US_WEST_1:{index:2,price:0.03},US_WEST_2:{index:3,price:0.035},
EU_WEST_1:{index:4,price:0.035},AP_SOUTHEAST_1:{index:5,price:0.035},AP_NORTHEAST_1:{index:6,price:0.035},SA_EAST_1:{index:7,price:0.037}}},M1_SMALL:{name:"m1.small",LINUX:{US_EAST_1:{index:1,price:0.08},US_WEST_1:{index:2,price:0.08},US_WEST_2:{index:3,price:0.09},EU_WEST_1:{index:4,price:0.09},AP_SOUTHEAST_1:{index:5,price:0.09},AP_NORTHEAST_1:{index:6,price:0.092},SA_EAST_1:{index:7,price:0.115}},WIN:{US_EAST_1:{index:1,price:0.115},US_WEST_1:{index:2,price:0.115},US_WEST_2:{index:3,price:0.125},
EU_WEST_1:{index:4,price:0.115},AP_SOUTHEAST_1:{index:5,price:0.115},AP_NORTHEAST_1:{index:6,price:0.115},SA_EAST_1:{index:7,price:0.15}}},M1_MEDIUM:{name:"m1.medium",LINUX:{US_EAST_1:{index:1,price:0.16},US_WEST_1:{index:2,price:0.16},US_WEST_2:{index:3,price:0.18},EU_WEST_1:{index:4,price:0.18},AP_SOUTHEAST_1:{index:5,price:0.18},AP_NORTHEAST_1:{index:6,price:0.184},SA_EAST_1:{index:7,price:0.23}},WIN:{US_EAST_1:{index:1,price:0.23},US_WEST_1:{index:2,price:0.23},US_WEST_2:{index:3,price:0.25},
EU_WEST_1:{index:4,price:0.23},AP_SOUTHEAST_1:{index:5,price:0.23},AP_NORTHEAST_1:{index:6,price:0.23},SA_EAST_1:{index:7,price:0.3}}},M1_LARGE:{name:"m1.large",LINUX:{US_EAST_1:{index:1,price:0.32},US_WEST_1:{index:2,price:0.32},US_WEST_2:{index:3,price:0.36},EU_WEST_1:{index:4,price:0.36},AP_SOUTHEAST_1:{index:5,price:0.36},AP_NORTHEAST_1:{index:6,price:0.368},SA_EAST_1:{index:7,price:0.46}},WIN:{US_EAST_1:{index:1,price:0.46},US_WEST_1:{index:2,price:0.46},US_WEST_2:{index:3,price:0.5},EU_WEST_1:{index:4,
price:0.46},AP_SOUTHEAST_1:{index:5,price:0.46},AP_NORTHEAST_1:{index:6,price:0.46},SA_EAST_1:{index:7,price:0.6}}},M1_XLARGE:{name:"m1.xlarge",LINUX:{US_EAST_1:{index:1,price:0.64},US_WEST_1:{index:2,price:0.64},US_WEST_2:{index:3,price:0.72},EU_WEST_1:{index:4,price:0.72},AP_SOUTHEAST_1:{index:5,price:0.72},AP_NORTHEAST_1:{index:6,price:0.736},SA_EAST_1:{index:7,price:0.92}},WIN:{US_EAST_1:{index:1,price:0.92},US_WEST_1:{index:2,price:0.92},US_WEST_2:{index:3,price:1},EU_WEST_1:{index:4,price:0.92},
AP_SOUTHEAST_1:{index:5,price:0.92},AP_NORTHEAST_1:{index:6,price:0.92},SA_EAST_1:{index:7,price:1.2}}},M2_XLARGE:{name:"m2.xlarge",LINUX:{US_EAST_1:{index:1,price:0.45},US_WEST_1:{index:2,price:0.45},US_WEST_2:{index:3,price:0.506},EU_WEST_1:{index:4,price:0.506},AP_SOUTHEAST_1:{index:5,price:0.506},AP_NORTHEAST_1:{index:6,price:0.518},SA_EAST_1:{index:7,price:0.68}},WIN:{US_EAST_1:{index:1,price:0.57},US_WEST_1:{index:2,price:0.57},US_WEST_2:{index:3,price:0.626},EU_WEST_1:{index:4,price:0.57},
AP_SOUTHEAST_1:{index:5,price:0.57},AP_NORTHEAST_1:{index:6,price:0.57},SA_EAST_1:{index:7,price:0.8}}},M2_2XLARGE:{name:"m2.2xlarge",LINUX:{US_EAST_1:{index:1,price:0.9},US_WEST_1:{index:2,price:0.9},US_WEST_2:{index:3,price:1.012},EU_WEST_1:{index:4,price:1.012},AP_SOUTHEAST_1:{index:5,price:1.012},AP_NORTHEAST_1:{index:6,price:1.036},SA_EAST_1:{index:7,price:1.36}},WIN:{US_EAST_1:{index:1,price:1.14},US_WEST_1:{index:2,price:1.14},US_WEST_2:{index:3,price:1.252},EU_WEST_1:{index:4,price:1.14},
AP_SOUTHEAST_1:{index:5,price:1.14},AP_NORTHEAST_1:{index:6,price:1.14},SA_EAST_1:{index:7,price:1.6}}},M2_4XLARGE:{name:"m2.4xlarge",LINUX:{US_EAST_1:{index:1,price:1.8},US_WEST_1:{index:2,price:1.8},US_WEST_2:{index:3,price:2.024},EU_WEST_1:{index:4,price:2.024},AP_SOUTHEAST_1:{index:5,price:2.024},AP_NORTHEAST_1:{index:6,price:2.072},SA_EAST_1:{index:7,price:2.72}},WIN:{US_EAST_1:{index:1,price:2.28},US_WEST_1:{index:2,price:2.28},US_WEST_2:{index:3,price:2.504},EU_WEST_1:{index:4,price:2.28},
AP_SOUTHEAST_1:{index:5,price:2.28},AP_NORTHEAST_1:{index:6,price:2.28},SA_EAST_1:{index:7,price:3.2}}},C1_MEDIUM:{name:"c1.medium",LINUX:{US_EAST_1:{index:1,price:0.165},US_WEST_1:{index:2,price:0.165},US_WEST_2:{index:3,price:0.186},EU_WEST_1:{index:4,price:0.186},AP_SOUTHEAST_1:{index:5,price:0.186},AP_NORTHEAST_1:{index:6,price:0.19},SA_EAST_1:{index:7,price:0.23}},WIN:{US_EAST_1:{index:1,price:0.285},US_WEST_1:{index:2,price:0.285},US_WEST_2:{index:3,price:0.306},EU_WEST_1:{index:4,price:0.285},
AP_SOUTHEAST_1:{index:5,price:0.285},AP_NORTHEAST_1:{index:6,price:0.285},SA_EAST_1:{index:7,price:0.35}}},C1_XLARGE:{name:"c1.xlarge",LINUX:{US_EAST_1:{index:1,price:0.66},US_WEST_1:{index:2,price:0.66},US_WEST_2:{index:3,price:0.744},EU_WEST_1:{index:4,price:0.744},AP_SOUTHEAST_1:{index:5,price:0.744},AP_NORTHEAST_1:{index:6,price:0.76},SA_EAST_1:{index:7,price:0.92}},WIN:{US_EAST_1:{index:1,price:1.14},US_WEST_1:{index:2,price:1.14},US_WEST_2:{index:3,price:1.224},EU_WEST_1:{index:4,price:1.14},
AP_SOUTHEAST_1:{index:5,price:1.14},AP_NORTHEAST_1:{index:6,price:1.14},SA_EAST_1:{index:7,price:1.4}}},CC1_4XLARGE:{name:"cc1.4xlarge",LINUX:{US_EAST_1:{index:1,price:1.3},US_WEST_1:{index:2,price:null},US_WEST_2:{index:3,price:null},EU_WEST_1:{index:4,price:null},AP_SOUTHEAST_1:{index:5,price:null},AP_NORTHEAST_1:{index:6,price:null},SA_EAST_1:{index:7,price:null}},WIN:{US_EAST_1:{index:1,price:1.61},US_WEST_1:{index:2,price:null},US_WEST_2:{index:3,price:null},EU_WEST_1:{index:4,price:null},AP_SOUTHEAST_1:{index:5,
price:null},AP_NORTHEAST_1:{index:6,price:null},SA_EAST_1:{index:7,price:null}}},CC2_8XLARGE:{name:"cc2.8xlarge",LINUX:{US_EAST_1:{index:1,price:2.4},US_WEST_1:{index:2,price:null},US_WEST_2:{index:3,price:null},EU_WEST_1:{index:4,price:null},AP_SOUTHEAST_1:{index:5,price:null},AP_NORTHEAST_1:{index:6,price:null},SA_EAST_1:{index:7,price:null}},WIN:{US_EAST_1:{index:1,price:2.97},US_WEST_1:{index:2,price:null},US_WEST_2:{index:3,price:null},EU_WEST_1:{index:4,price:null},AP_SOUTHEAST_1:{index:5,price:null},
AP_NORTHEAST_1:{index:6,price:null},SA_EAST_1:{index:7,price:null}}},CG1_4XLARGE:{name:"cg1.4xlarge",LINUX:{US_EAST_1:{index:1,price:2.1},US_WEST_1:{index:2,price:null},US_WEST_2:{index:3,price:null},EU_WEST_1:{index:4,price:null},AP_SOUTHEAST_1:{index:5,price:null},AP_NORTHEAST_1:{index:6,price:null},SA_EAST_1:{index:7,price:null}},WIN:{US_EAST_1:{index:1,price:2.6},US_WEST_1:{index:2,price:null},US_WEST_2:{index:3,price:null},EU_WEST_1:{index:4,price:null},AP_SOUTHEAST_1:{index:5,price:null},AP_NORTHEAST_1:{index:6,
price:null},SA_EAST_1:{index:7,price:null}}}}},STORAGE:{EBS:{US_EAST_1:{store_price:0.1,io_request:0.1,snap_price:0.125},US_WEST_1:{store_price:0.1,io_request:0.1,snap_price:0.125},US_WEST_2:{store_price:0.11,io_request:0.11,snap_price:0.14},EU_WEST_1:{store_price:0.11,io_request:0.11,snap_price:0.125},AP_SOUTHEAST_1:{store_price:0.11,io_request:0.11,snap_price:0.125},AP_NORTHEAST_1:{store_price:0.12,io_request:0.12,snap_price:0.13},SA_EAST_1:{store_price:0.19,io_request:0.14,snap_price:0.17}},S3:{US_EAST_1:{store_price:[[1E3,
0.125],[49E3,0.11],[45E4,0.095],[5E5,0.09],[4E6,0.08],[5E6,0.055]],rrstore_price:[[1E3,0.093],[49E3,0.083],[45E4,0.073],[5E5,0.063],[4E6,0.053],[5E6,0.037]],in_request:0.01,out_request:0.01},US_WEST_1:{store_price:[[1E3,0.125],[49E3,0.11],[45E4,0.095],[5E5,0.09],[4E6,0.08],[5E6,0.055]],rrstore_price:[[1E3,0.093],[49E3,0.083],[45E4,0.073],[5E5,0.063],[4E6,0.053],[5E6,0.037]],in_request:0.01,out_request:0.01},US_WEST_2:{store_price:[[1E3,0.14],[49E3,0.125],[45E4,0.115],[5E5,0.105],[4E6,0.095],[5E6,
0.07]],rrstore_price:[[1E3,0.103],[49E3,0.093],[45E4,0.083],[5E5,0.073],[4E6,0.063],[5E6,0.047]],in_request:0.011,out_request:0.011},EU_WEST_1:{store_price:[[1E3,0.125],[49E3,0.11],[45E4,0.095],[5E5,0.09],[4E6,0.08],[5E6,0.055]],rrstore_price:[[1E3,0.093],[49E3,0.083],[45E4,0.073],[5E5,0.063],[4E6,0.053],[5E6,0.037]],in_request:0.01,out_request:0.01},AP_SOUTHEAST_1:{store_price:[[1E3,0.125],[49E3,0.11],[45E4,0.095],[5E5,0.09],[4E6,0.08],[5E6,0.055]],rrstore_price:[[1E3,0.093],[49E3,0.083],[45E4,0.073],
[5E5,0.063],[4E6,0.053],[5E6,0.037]],in_request:0.01,out_request:0.01},AP_NORTHEAST_1:{store_price:[[1E3,0.13],[49E3,0.115],[45E4,0.1],[5E5,0.095],[4E6,0.085],[5E6,0.06]],rrstore_price:[[1E3,0.1],[49E3,0.09],[45E4,0.08],[5E5,0.07],[4E6,0.06],[5E6,0.044]],in_request:0.01,out_request:0.01},SA_EAST_1:{store_price:[[1E3,0.17],[49E3,0.15],[45E4,0.13],[5E5,0.12],[4E6,0.11],[5E6,0.075]],rrstore_price:[[1E3,0.127],[49E3,0.113],[45E4,0.1],[5E5,0.087],[4E6,0.073],[5E6,0.05]],in_request:0.014,out_request:0.014}}},
BANDWIDTH:{US_EAST_1:{data_in:0,data_out:[[1,0],[1E4,0.12],[4E4,0.09],[1E5,0.07],[35E4,0.05]]},US_WEST_1:{data_in:0,data_out:[[1,0],[1E4,0.12],[4E4,0.09],[1E5,0.07],[35E4,0.05]]},US_WEST_2:{data_in:0,data_out:[[1,0],[1E4,0.12],[4E4,0.09],[1E5,0.07],[35E4,0.05]]},EU_WEST_1:{data_in:0,data_out:[[1,0],[1E4,0.12],[4E4,0.09],[1E5,0.07],[35E4,0.05]]},AP_SOUTHEAST_1:{data_in:0,data_out:[[1,0],[1E4,0.19],[4E4,0.15],[1E5,0.13],[35E4,0.12]]},AP_NORTHEAST_1:{data_in:0,data_out:[[1,0],[1E4,0.201],[4E4,0.158],
[1E5,0.137],[35E4,0.127]]},SA_EAST_1:{data_in:0,data_out:[[1,0],[1E4,0.25],[4E4,0.23],[1E5,0.21],[35E4,0.19]]}}};
$(function(){var d=Backbone.Model.extend({defaults:function(){return{qty:1,name:"Server",instanceSize:AWS.COMPUTE.EC2.T1_MICRO,os:OS.LINUX,region:AWS.REGIONS.US_EAST_1,hoursPerMonth:730,cost:"0.00"}},initialize:function(){this.bind("change:qty",function(){this.calc()});this.bind("change:hoursPerMonth",function(){this.calc()});this.bind("change:instanceSize",function(){this.calc()});this.bind("change:os",function(){this.calc()});this.bind("change:region",function(){this.calc()})},calc:function(){var a=
0;if(this.get("os")==OS.LINUX){var b=this.get("instanceSize").LINUX,c;for(c in b)if(this.get("region").index==b[c].index){a=b[c].price;break}}else if(this.get("os")==OS.WIN)for(c in b=this.get("instanceSize").WIN,b){if(this.get("region").index==b[c].index){a=b[c].price;break}}else console.log("can't find OS");this.set({cost:(this.get("qty")*this.get("hoursPerMonth")*a).toFixed(2)})},clear:function(){this.destroy()}});Backbone.Model.extend({defaults:function(){return{qty:1,name:"Data Volume",size:1,
vendor:VENDORS.AWS,region:AWS.REGIONS.US_EAST_1,cost:"0.00"}}}).extend({defaults:function(){return{ioRequests:10}}});var e=Backbone.View.extend({model:d,tagName:"div",className:"row",attributes:{style:"margin-bottom: 20px"},blockId:0,template:_.template($("#compute-block-template").html()),events:{"click button.destroy":"clear","keyup #qty":"setQty","keyup #name":"setName","change #os":"setOS","keyup #os":"setOS","change #instance-size":"setInstanceSize","keyup #instance-size":"setInstanceSize","change #region":"setRegion",
"keyup #region":"setRegion","keyup #hours-per-month":"setHoursPerMonth"},initialize:function(){this.options.blockId&&(this.blockId=this.options.blockId);this.model.bind("destroy",this.remove,this)},render:function(){this.model.calc();this.$el.html(this.template(this.model.toJSON()));return this},setQty:function(){var a=this.$("#qty").val();this.model.set({qty:parseInt(a,10)});this.updateCost()},setName:function(){this.model.set({name:this.$("#name").val()})},setOS:function(){var a=this.$("#os").val();
"Linux"==a?this.model.set({os:OS.LINUX}):"Windows"==a?this.model.set({os:OS.WIN}):console.log("can't find OS");this.updateCost()},setInstanceSize:function(){var a=this.$("#instance-size").val();for(sz in AWS.COMPUTE.EC2)if(a==AWS.COMPUTE.EC2[sz].name){this.model.set({instanceSize:AWS.COMPUTE.EC2[sz]});break}this.updateCost()},setRegion:function(){var a=this.$("#region").val();for(region in AWS.REGIONS)if(a==AWS.REGIONS[region].name){this.model.set({region:AWS.REGIONS[region]});break}this.updateCost()},
setHoursPerMonth:function(){var a=this.$("#hours-per-month").val();this.model.set({hoursPerMonth:parseInt(a,10)});this.updateCost()},updateCost:function(){var a=this.$("#cost"),b=this.model.get("cost");"NaN"==b&&(b="0.00");a.text("$"+b)},clear:function(){console.log("["+this.blockId+"] Goodbye "+this.model.get("name")+"!");this.model.clear()}});new (Backbone.View.extend({el:$("#kloudcalc-app"),numBlocks:1,events:{"click #add-compute-block":"addComputeBlock","keyup '#block-list,#cost'":"updateTotalCost",
"click '#block-list,#cost'":"updateTotalCost","change '#block-list,#cost'":"updateTotalCost","click '#block-list,button.destroy'":"updateTotalCost"},initialize:function(){this.options.numBlocks&&(this.numBlocks=this.options.numBlocks);this.header=this.$("#header");this.totalCostField=this.$("#total-cost");this.blockList=this.$("#block-list");this.main=this.$("#main");this.footer=this.$("footer")},addComputeBlock:function(){var a=new e({model:new d,id:"compute-block-"+this.numBlocks,blockId:this.numBlocks});
this.numBlocks+=1;this.blockList.append(a.render().el);this.updateTotalCost()},updateTotalCost:function(){var a=0;this.$("#cost").each(function(){a+=parseFloat($(this).text().split("$")[1])});this.totalCostField.text("$"+a.toFixed(2))}}))});
